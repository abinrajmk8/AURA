# -----------------------------
# HAProxy configuration for Cowrie Honeypot
# -----------------------------

global
    maxconn 4096
    daemon

defaults
    option  dontlognull
    timeout connect 5s
    timeout client  50s
    timeout server  50s

# -----------------------------
# Frontend: Accepts external SSH traffic
# -----------------------------
frontend ssh_front
    bind *:2222
    mode tcp
    default_backend cowrie_backends

# -----------------------------
# Backend: Distributes traffic to Cowrie containers
# -----------------------------
backend cowrie_backends
    mode tcp
    balance roundrobin

    server cowrie_a cowrie_a:2222 check
    server cowrie_b cowrie_b:2222 check

